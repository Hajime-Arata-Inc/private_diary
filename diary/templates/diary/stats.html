{% extends "base.html" %}
{% load form_filters %}

{% block content %}
    <h2 class="mb-4">ğŸ“ˆ åˆ†æãƒšãƒ¼ã‚¸</h2>

    <p class="text-muted">ç¾åœ¨ã®ç·æŠ•ç¨¿æ•°ï¼š<strong>{{ diary_count }}</strong> ä»¶</p>

    <h3 class="mt-4">æ—¥åˆ¥æŠ•ç¨¿æ•°ï¼ˆãƒªã‚¹ãƒˆï¼‰</h3>
    <ul class="list-group mb-5">
    {% for item in daily_counts %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
        {{ item.date|date:"Yå¹´mæœˆdæ—¥" }}
        <span class="badge bg-primary rounded-pill">{{ item.count }} ä»¶</span>
        </li>
    {% empty %}
        <li class="list-group-item">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>
    {% endfor %}
    </ul>

    <h3>ğŸ“Š æ—¥åˆ¥æŠ•ç¨¿ã‚°ãƒ©ãƒ•</h3>
<div class="container p-4 mt-4 rounded" style="background-color: #ffffff;">
  <canvas id="diaryChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('diaryChart').getContext('2d');
const diaryChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: [
      {% for item in daily_counts %}
        "{{ item.date|date:'Y-m-d' }}"{% if not forloop.last %},{% endif %}
      {% endfor %}
    ],
    datasets: [{
      label: 'æŠ•ç¨¿æ•°',
      data: [
        {% for item in daily_counts %}
          {{ item.count }}{% if not forloop.last %},{% endif %}
        {% endfor %}
      ],
      fill: false,
      borderColor: 'rgba(54, 162, 235, 1)',
      borderWidth: 2,
      tension: 0.1,

      pointStyle: 'circle',                   // å¡—ã‚Šã¤ã¶ã—ä¸¸
      pointRadius: 4,
      pointHoverRadius: 6,
      pointBackgroundColor: 'rgba(54, 162, 235, 1)',
      pointBorderColor: '#fff',

      backgroundColor: 'transparent'
    }]
  },
  options: {
    plugins: {
      legend: {
        labels: {
          usePointStyle: true                 // å‡¡ä¾‹ã‚’ç·šé¢¨ã«
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          stepSize: 1
        }
      }
    }
  }
});
</script>


<div class="text-center mt-4">
    <a href="/" class="btn btn-secondary">æ—¥è¨˜ä¸€è¦§ã¸æˆ»ã‚‹</a>
</div>


{% endblock %}
