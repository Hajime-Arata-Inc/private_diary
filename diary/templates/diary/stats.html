{% extends "base.html" %}
{% load form_filters %}

{% block content %}
    <h2 class="mb-4">ğŸ“ˆ åˆ†æãƒšãƒ¼ã‚¸</h2>

    <p class="text-muted">ç¾åœ¨ã®ç·æŠ•ç¨¿æ•°ï¼š<strong>{{ diary_count }}</strong> ä»¶</p>

    <h3 class="mt-4">æ—¥åˆ¥æŠ•ç¨¿æ•°ï¼ˆãƒªã‚¹ãƒˆï¼‰</h3>
    <ul class="list-group mb-5">
    {% for item in daily_counts %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
        {{ item.date|date:"Yå¹´mæœˆdæ—¥" }}
        <span class="badge bg-primary rounded-pill">{{ item.count }} ä»¶</span>
        </li>
    {% empty %}
        <li class="list-group-item">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>
    {% endfor %}
    </ul>

    <h3>ğŸ“Š æ—¥åˆ¥æŠ•ç¨¿ã‚°ãƒ©ãƒ•</h3>
    <canvas id="diaryChart" width="400" height="200"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    const ctx = document.getElementById('diaryChart');
    const diaryChart = new Chart(ctx, {
        type: 'bar',
        data: {
        labels: [
            {% for item in daily_counts %}
            "{{ item.date|date:'Y-m-d' }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        ],
        datasets: [{
            label: 'æŠ•ç¨¿æ•°',
            data: [
            {% for item in daily_counts %}
                {{ item.count }}{% if not forloop.last %},{% endif %}
            {% endfor %}
            ],
            backgroundColor: 'rgba(75, 192, 192, 0.5)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
        },
        options: {
        scales: {
            y: {
            beginAtZero: true,
            ticks: { stepSize: 1 }
            }
        }
        }
    });
    </script>
{% endblock %}
